---
layout: src/layouts/Default.astro
pubDate: 2016-06-13
title: 'Sitecore - Settings & Variable Replacement'
description: >-
The default [Configuration Variables](https://octopus.com/docs/deployment-process/configuration-features#Configurationfiles-ConfigurationVariables) functionality replaces **appSettings** and **connectionStrings** entries. This step template extends this functionality to the Sitecore configuration **settings** and **sc.variable** nodes within the configuration file(s) that you specify. Variables that are defined for the Octopus project will automatically replace those defined in the target Sitecore configuration file(s).
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2016-06-13 by dthunziker belongs to 'Sitecore' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Sitecore.ReplaceConfigFiles

`Sitecore.ReplaceConfigFiles`

Enter the full path to your Sitecore configuration file(s) that contains the **sitecore** node, one per line. For versions of Sitecore prior to 8.1, this should point to your primary Web.config at the root of your website, and for versions 8.1+, to the Sitecore.config file within your App_Config folder. Alternatively, this value can be left empty and defined within your Octopus project's variable collection using the variable name **Sitecore.ReplaceConfigFiles**.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
$ErrorActionPreference = "Stop" 
$configFiles = $OctopusParameters["Sitecore.ReplaceConfigFiles"]

if ([string]::IsNullOrEmpty($configFiles)) {
    throw [System.ArgumentNullException] "Sitecore.ReplaceConfigFiles"
}

($configFiles -split '[\r\n]') | ForEach-Object {
    
    $configPath = $_

    if ([string]::IsNullOrEmpty($configPath)) { 
        return
    }
    
    $configPath = $configPath.Trim()

    if (-not (Test-Path -LiteralPath $configPath)) {
        Write-Host "$configPath was not found."
        return
    }

    Write-Host "Searching Sitecore config file for replacement variables:" $configPath
        
    $configXml = [xml](Get-Content $configPath)
    $sitecoreNode = $configXml.sitecore
    
    # Look for sitecore node for versions prior to 8.1
    if ($sitecoreNode -eq $null) {
        $sitecoreNode = $configXml.configuration.sitecore
    }
    
    # Ensure that we have a sitecore node to work from
    if ($sitecoreNode -eq $null -or $sitecoreNode.settings -eq $null) {
        Write-Host "The sitecore settings node was not found in" $configPath ". Skipping this file..."
        return
    }
    
    foreach ($key in $OctopusParameters.Keys) {
    
        # Replace Sitecore settings
        $setting = $sitecoreNode.settings.setting | where { $_.name -ceq $key }
        if ($setting -ne $null) {
            Write-Host $setting.name "setting will be updated from" $setting.value "to" $OctopusParameters[$key] "in" $configPath
            $setting.value = $OctopusParameters[$key]
        }
    
        # Replace Sitecore variables
        $variable = $sitecoreNode.'sc.variable' | where { $_.name -ceq $key }
        if ($variable -ne $null) {
            Write-Host $variable.name "Sitecore variable will be updated from" $settingsNode.value "to" $OctopusParameters[$key] "in" $configPath
            $variable.value = $OctopusParameters[$key]
        }
    
    }
    
    $configXml.Save($configPath)
}
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20Sitecore%20-%20Settings%20%26%20Variable%20Replacement&step-template=Sitecore%20-%20Settings%20%26%20Variable%20Replacement)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "382b9610-64c4-4c64-a31c-34d07f262ed4",
  "Name": "Sitecore - Settings & Variable Replacement",
  "Description": "The default [Configuration Variables](https://octopus.com/docs/deployment-process/configuration-features#Configurationfiles-ConfigurationVariables) functionality replaces **appSettings** and **connectionStrings** entries. This step template extends this functionality to the Sitecore configuration **settings** and **sc.variable** nodes within the configuration file(s) that you specify. Variables that are defined for the Octopus project will automatically replace those defined in the target Sitecore configuration file(s).",
  "Version": 2,
  "ExportedAt": "2016-06-13T17:19:09.003+00:00",
  "ActionType": "Octopus.Script",
  "Author": "dthunziker",
  "Parameters": [
    {
      "Name": "Sitecore.ReplaceConfigFiles",
      "Label": "Sitecore.ReplaceConfigFiles",
      "HelpText": "Enter the full path to your Sitecore configuration file(s) that contains the **sitecore** node, one per line. For versions of Sitecore prior to 8.1, this should point to your primary Web.config at the root of your website, and for versions 8.1+, to the Sitecore.config file within your App_Config folder. Alternatively, this value can be left empty and defined within your Octopus project's variable collection using the variable name **Sitecore.ReplaceConfigFiles**.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "MultiLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.Syntax": "PowerShell",
    "Octopus.Action.Script.ScriptSource": "Inline",
    "Octopus.Action.Script.ScriptBody": "$ErrorActionPreference = \"Stop\" \n$configFiles = $OctopusParameters[\"Sitecore.ReplaceConfigFiles\"]\n\nif ([string]::IsNullOrEmpty($configFiles)) {\n    throw [System.ArgumentNullException] \"Sitecore.ReplaceConfigFiles\"\n}\n\n($configFiles -split '[\\r\\n]') | ForEach-Object {\n    \n    $configPath = $_\n\n    if ([string]::IsNullOrEmpty($configPath)) { \n        return\n    }\n    \n    $configPath = $configPath.Trim()\n\n    if (-not (Test-Path -LiteralPath $configPath)) {\n        Write-Host \"$configPath was not found.\"\n        return\n    }\n\n    Write-Host \"Searching Sitecore config file for replacement variables:\" $configPath\n        \n    $configXml = [xml](Get-Content $configPath)\n    $sitecoreNode = $configXml.sitecore\n    \n    # Look for sitecore node for versions prior to 8.1\n    if ($sitecoreNode -eq $null) {\n        $sitecoreNode = $configXml.configuration.sitecore\n    }\n    \n    # Ensure that we have a sitecore node to work from\n    if ($sitecoreNode -eq $null -or $sitecoreNode.settings -eq $null) {\n        Write-Host \"The sitecore settings node was not found in\" $configPath \". Skipping this file...\"\n        return\n    }\n    \n    foreach ($key in $OctopusParameters.Keys) {\n    \n        # Replace Sitecore settings\n        $setting = $sitecoreNode.settings.setting | where { $_.name -ceq $key }\n        if ($setting -ne $null) {\n            Write-Host $setting.name \"setting will be updated from\" $setting.value \"to\" $OctopusParameters[$key] \"in\" $configPath\n            $setting.value = $OctopusParameters[$key]\n        }\n    \n        # Replace Sitecore variables\n        $variable = $sitecoreNode.'sc.variable' | where { $_.name -ceq $key }\n        if ($variable -ne $null) {\n            Write-Host $variable.name \"Sitecore variable will be updated from\" $settingsNode.value \"to\" $OctopusParameters[$key] \"in\" $configPath\n            $variable.value = $OctopusParameters[$key]\n        }\n    \n    }\n    \n    $configXml.Save($configPath)\n}",
    "Octopus.Action.Script.ScriptFileName": null,
    "Octopus.Action.Package.NuGetFeedId": null,
    "Octopus.Action.Package.NuGetPackageId": null
  },
  "Category": "Sitecore",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/sitecore-settings-variable-replacement.json",
  "Website": "/step-templates/382b9610-64c4-4c64-a31c-34d07f262ed4",
  "Logo": "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",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/sitecore-settings-variable-replacement.json)

</div>
