---
layout: src/layouts/Default.astro
pubDate: 2015-10-20
title: 'ClickOnceRe-Sign'
description: >-
This Template will help to re-sign the .application and manifest files. Finally add .deploy extenstion to the files
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2015-10-20 by mani0070 belongs to 'ClickOnce' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Signing Certificate Path

`signcertpath`

null

</div>
        
<div class="param">

### Signing Certificate Password

`signCertPass`

null

</div>
        
<div class="param">

### Deployment Path

`baseDeployPath`

null

</div>
        
<div class="param">

### Application Name

`AppName`

null

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
$xml = [xml](Get-Content "$baseDeployPath\$AppName.application")
$manifestpath = $xml.assembly.dependency.dependentAssembly.codebase
$ApplicationWithVersion = $manifestpath.Split('\\')[1]

#Manifest Resign
& "C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\mage.exe" -Update "$baseDeployPath\$manifestpath" -FromDirectory "$baseDeployPath\Application Files\$ApplicationWithVersion"
& "C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\mage.exe" -Sign "$baseDeployPath\$manifestpath" -CertFile $signcertpath -Password $signCertPass

#Application Resign
& "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\mage.exe" -Update "$baseDeployPath\$AppName.application" -AppManifest "$baseDeployPath\$manifestpath"
& "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\mage.exe" -Sign "$baseDeployPath\$AppName.application" -CertFile $signcertpath -Password $signCertPass

#Rename files back to the .deploy extension, skipping the files that shouldn't be renamed
Get-ChildItem -Path "$baseDeployPath\Application Files\*"  -Recurse | Where-Object {!$_.PSIsContainer -and $_.Name -notlike "*.manifest" -and $_.Name -notlike "*.vsto"} | Rename-Item -NewName {$_.Name + ".deploy"} 
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20ClickOnceRe-Sign&step-template=ClickOnceRe-Sign)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "a9e5843e-d382-44fd-84dd-d999dab54993",
  "Name": "ClickOnceRe-Sign",
  "Description": "This Template will help to re-sign the .application and manifest files. Finally add .deploy extenstion to the files",
  "Version": 6,
  "ExportedAt": "2015-10-20T20:26:27.693+00:00",
  "ActionType": "Octopus.Script",
  "Author": "mani0070",
  "Parameters": [
    {
      "Name": "signcertpath",
      "Label": "Signing Certificate Path",
      "HelpText": null,
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "signCertPass",
      "Label": "Signing Certificate Password",
      "HelpText": null,
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "baseDeployPath",
      "Label": "Deployment Path",
      "HelpText": null,
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "AppName",
      "Label": "Application Name",
      "HelpText": null,
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.Syntax": "PowerShell",
    "Octopus.Action.Script.ScriptBody": "$xml = [xml](Get-Content \"$baseDeployPath\\$AppName.application\")\n$manifestpath = $xml.assembly.dependency.dependentAssembly.codebase\n$ApplicationWithVersion = $manifestpath.Split('\\\\')[1]\n\n#Manifest Resign\n& \"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v8.0A\\bin\\NETFX 4.0 Tools\\mage.exe\" -Update \"$baseDeployPath\\$manifestpath\" -FromDirectory \"$baseDeployPath\\Application Files\\$ApplicationWithVersion\"\n& \"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v8.0A\\bin\\NETFX 4.0 Tools\\mage.exe\" -Sign \"$baseDeployPath\\$manifestpath\" -CertFile $signcertpath -Password $signCertPass\n\n#Application Resign\n& \"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\\mage.exe\" -Update \"$baseDeployPath\\$AppName.application\" -AppManifest \"$baseDeployPath\\$manifestpath\"\n& \"C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v7.0A\\Bin\\mage.exe\" -Sign \"$baseDeployPath\\$AppName.application\" -CertFile $signcertpath -Password $signCertPass\n\n#Rename files back to the .deploy extension, skipping the files that shouldn't be renamed\nGet-ChildItem -Path \"$baseDeployPath\\Application Files\\*\"  -Recurse | Where-Object {!$_.PSIsContainer -and $_.Name -notlike \"*.manifest\" -and $_.Name -notlike \"*.vsto\"} | Rename-Item -NewName {$_.Name + \".deploy\"} "
  },
  "Category": "ClickOnce",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/clickonce-re-sign.json",
  "Website": "/step-templates/a9e5843e-d382-44fd-84dd-d999dab54993",
  "Logo": "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",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/clickonce-re-sign.json)

</div>
