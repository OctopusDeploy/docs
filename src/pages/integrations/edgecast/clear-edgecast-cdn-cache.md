---
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
layout: src/layouts/Default.astro
pubDate: 2015-02-20
title: 'Clear EdgeCast CDN Cache'
description: 'This step will clear (purge) the EdgeCast CDN Cache'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
---

Octopus.Script exported 2015-02-20 by yooakim belongs to 'EdgeCast' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### null

`AccountNumber`

CDN Account number, can be found in MCC

</div>
        
<div class="param">

### null

`ApiToken`

API token for accessing the EdgeCast API for the account

</div>
        
<div class="param">

### null

`MediaPath`

A string that indicates the CDN or edge CNAME URL for the asset or the location that will be purged from our edge servers. Make sure to include the proper protocol (i.e., http:// or rtmp://).

</div>
        
<div class="param">

### MediaType

`MediaType = 3`

An integer that indicates the service for which an asset will be purged. It should be replaced with the ID associated with the desired service., default is 3. HTTP Large

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
function Clear-EdgeCastCache
{
    [CmdletBinding()]
    Param
    (
        # CDN Account number, can be found in MCC
        [Parameter(Mandatory=$true)]
        $AccountNumber,

        # API Token
        [Parameter(Mandatory=$true)]
        [string]$ApiToken,

         # A string that indicates the CDN or edge CNAME URL for the asset or the location that will be purged from our edge servers. Make sure to include the proper protocol (i.e., http:// or rtmp://).
        [Parameter(Mandatory=$true)]
        [string]
        $MediaPath,

        #An integer that indicates the service for which an asset will be purged. It should be replaced with the ID associated with the desired service., default is 3. HTTP Large
        [ValidateSet(2,3,8,14)]
        [int]
        $MediaType=3
    )

    Begin
    {
        $uri = "https://api.edgecast.com/v2/mcc/customers/$AccountNumber/edge/purge"

        $headers = @{
            'Authorization' = "tok:" + $ApiToken
            'Accept' = 'Application/JSON'
            'Content-Type' = 'Application/JSON'
            }
        $RequestParameters = @{
            'MediaPath'=$MediaPath
            'MediaType'=$MediaType
        }

        $body = ConvertTo-Json $RequestParameters

    }
    Process
    {
        Write-Verbose "Request body $body"
    	$request = Invoke-RestMethod -Method PUT -Uri $uri -Headers $headers -Body $body -DisableKeepAlive
        $request

    }
    End
    {
    }
}

Clear-EdgeCastCache -AccountNumber $AccountNumber -ApiToken $ApiToken -MediaPath $MediaPath -MediaType $MediaType -Verbose

```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20Clear%20EdgeCast%20CDN%20Cache&step-template=Clear%20EdgeCast%20CDN%20Cache)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "d97ff2d4-250a-4a1a-bd5e-36644893888c",
  "Name": "Clear EdgeCast CDN Cache",
  "Description": "This step will clear (purge) the EdgeCast CDN Cache",
  "Version": 1,
  "ExportedAt": "2015-02-20T16:10:46.008+00:00",
  "ActionType": "Octopus.Script",
  "Author": "yooakim",
  "Parameters": [
    {
      "Name": "AccountNumber",
      "Label": null,
      "HelpText": "CDN Account number, can be found in MCC",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "ApiToken",
      "Label": null,
      "HelpText": "API token for accessing the EdgeCast API for the account",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "Sensitive"
      }
    },
    {
      "Name": "MediaPath",
      "Label": null,
      "HelpText": "A string that indicates the CDN or edge CNAME URL for the asset or the location that will be purged from our edge servers. Make sure to include the proper protocol (i.e., http:// or rtmp://).",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "MediaType",
      "Label": "MediaType",
      "HelpText": "An integer that indicates the service for which an asset will be purged. It should be replaced with the ID associated with the desired service., default is 3. HTTP Large",
      "DefaultValue": "3",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "function Clear-EdgeCastCache\n{\n    [CmdletBinding()]\n    Param\n    (\n        # CDN Account number, can be found in MCC\n        [Parameter(Mandatory=$true)]\n        $AccountNumber,\n\n        # API Token\n        [Parameter(Mandatory=$true)]\n        [string]$ApiToken,\n\n         # A string that indicates the CDN or edge CNAME URL for the asset or the location that will be purged from our edge servers. Make sure to include the proper protocol (i.e., http:// or rtmp://).\n        [Parameter(Mandatory=$true)]\n        [string]\n        $MediaPath,\n\n        #An integer that indicates the service for which an asset will be purged. It should be replaced with the ID associated with the desired service., default is 3. HTTP Large\n        [ValidateSet(2,3,8,14)]\n        [int]\n        $MediaType=3\n    )\n\n    Begin\n    {\n        $uri = \"https://api.edgecast.com/v2/mcc/customers/$AccountNumber/edge/purge\"\n\n        $headers = @{\n            'Authorization' = \"tok:\" + $ApiToken\n            'Accept' = 'Application/JSON'\n            'Content-Type' = 'Application/JSON'\n            }\n        $RequestParameters = @{\n            'MediaPath'=$MediaPath\n            'MediaType'=$MediaType\n        }\n\n        $body = ConvertTo-Json $RequestParameters\n\n    }\n    Process\n    {\n        Write-Verbose \"Request body $body\"\n    \t$request = Invoke-RestMethod -Method PUT -Uri $uri -Headers $headers -Body $body -DisableKeepAlive\n        $request\n\n    }\n    End\n    {\n    }\n}\n\nClear-EdgeCastCache -AccountNumber $AccountNumber -ApiToken $ApiToken -MediaPath $MediaPath -MediaType $MediaType -Verbose\n",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "EdgeCast",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/edgecast-cdn-purge.json",
  "Website": "/step-templates/d97ff2d4-250a-4a1a-bd5e-36644893888c",
  "Logo": "https://i.octopus.com/library/step-templates/edgecast.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/edgecast-cdn-purge.json)

</div>
