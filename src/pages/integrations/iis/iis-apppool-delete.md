---
layout: src/layouts/Default.astro
pubDate: 2014-07-29
title: 'IIS AppPool - Delete'
description: 'Deletes an IIS Application Pool. 
CAUTION: Delete will proceed even if applications are using the Application Pool.'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2014-07-29 by zagrophyte belongs to 'IIS' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Application pool name

`AppPoolName`

The name of the application pool that will be deleted.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
## --------------------------------------------------------------------------------------
## Input
## --------------------------------------------------------------------------------------

$appPoolName = $OctopusParameters['AppPoolName']

## --------------------------------------------------------------------------------------
## Helpers
## --------------------------------------------------------------------------------------
# Helper for validating input parameters
function Validate-Parameter([string]$foo, [string[]]$validInput, $parameterName) {
    IF (! $parameterName -contains "Password") 
    { 
        Write-Host "${parameterName}: $foo" 
    }
    if (! $foo) {
        throw "No value was set for $parameterName, and it cannot be empty"
    }
}

## --------------------------------------------------------------------------------------
## Configuration
## --------------------------------------------------------------------------------------
Validate-Parameter $appPoolName -parameterName "Application Pool Name"

#Load Web Admin DLL
[System.Reflection.Assembly]::LoadFrom( "C:\windows\system32\inetsrv\Microsoft.Web.Administration.dll" )

Add-PSSnapin WebAdministration -ErrorAction SilentlyContinue
Import-Module WebAdministration -ErrorAction SilentlyContinue


## --------------------------------------------------------------------------------------
## Run
## --------------------------------------------------------------------------------------

$iis = (New-Object Microsoft.Web.Administration.ServerManager)

$appPool = $iis.ApplicationPools | Where {$_.Name -eq $appPoolName} | Select-Object -First 1

IF ($appPool -eq $null)
{
    Write-Output "Could not find an Application Pool named '$appPoolName'"
}
ELSE
{
    Write-Output "Removing Application Pool '$appPoolName'"
    $iis.ApplicationPools.Remove($appPool)
    $iis.CommitChanges()
}


```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20IIS%20AppPool%20-%20Delete&step-template=IIS%20AppPool%20-%20Delete)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "a7120f3e-6676-4bbb-b848-1413b03a35e8",
  "Name": "IIS AppPool - Delete",
  "Description": "Deletes an IIS Application Pool. \nCAUTION: Delete will proceed even if applications are using the Application Pool.",
  "Version": 14,
  "ExportedAt": "2014-07-29T17:06:59.269+00:00",
  "ActionType": "Octopus.Script",
  "Author": "zagrophyte",
  "Parameters": [
    {
      "Name": "AppPoolName",
      "Label": "Application pool name",
      "HelpText": "The name of the application pool that will be deleted.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "## --------------------------------------------------------------------------------------\n## Input\n## --------------------------------------------------------------------------------------\n\n$appPoolName = $OctopusParameters['AppPoolName']\n\n## --------------------------------------------------------------------------------------\n## Helpers\n## --------------------------------------------------------------------------------------\n# Helper for validating input parameters\nfunction Validate-Parameter([string]$foo, [string[]]$validInput, $parameterName) {\n    IF (! $parameterName -contains \"Password\") \n    { \n        Write-Host \"${parameterName}: $foo\" \n    }\n    if (! $foo) {\n        throw \"No value was set for $parameterName, and it cannot be empty\"\n    }\n}\n\n## --------------------------------------------------------------------------------------\n## Configuration\n## --------------------------------------------------------------------------------------\nValidate-Parameter $appPoolName -parameterName \"Application Pool Name\"\n\n#Load Web Admin DLL\n[System.Reflection.Assembly]::LoadFrom( \"C:\\windows\\system32\\inetsrv\\Microsoft.Web.Administration.dll\" )\n\nAdd-PSSnapin WebAdministration -ErrorAction SilentlyContinue\nImport-Module WebAdministration -ErrorAction SilentlyContinue\n\n\n## --------------------------------------------------------------------------------------\n## Run\n## --------------------------------------------------------------------------------------\n\n$iis = (New-Object Microsoft.Web.Administration.ServerManager)\n\n$appPool = $iis.ApplicationPools | Where {$_.Name -eq $appPoolName} | Select-Object -First 1\n\nIF ($appPool -eq $null)\n{\n    Write-Output \"Could not find an Application Pool named '$appPoolName'\"\n}\nELSE\n{\n    Write-Output \"Removing Application Pool '$appPoolName'\"\n    $iis.ApplicationPools.Remove($appPool)\n    $iis.CommitChanges()\n}\n\n",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "IIS",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/iis-apppool-delete.json",
  "Website": "/step-templates/a7120f3e-6676-4bbb-b848-1413b03a35e8",
  "Logo": "https://i.octopus.com/library/step-templates/iis.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/iis-apppool-delete.json)

</div>
