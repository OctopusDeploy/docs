---
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
layout: src/layouts/Default.astro
pubDate: 2017-07-31
title: 'IIS - Reset'
description: 'Starts, stops, or resets IIS using iisreset'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
---

Octopus.Script exported 2017-07-31 by zappy-shu belongs to 'IIS' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Wait for command to finish

`iisWait = True`

null

</div>
        
<div class="param">

### Action on error

`iisErrorAction = Stop`



</div>
        
<div class="param">

### Action

`iisAction = /RESTART`

Start, stop, or reset

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
$wait = $OctopusParameters["iisWait"] -and [boolean]::Parse($OctopusParameters["iisWait"])
$action = $OctopusParameters["iisAction"]
$errorAction = $OctopusParameters["iisErrorAction"]
if ($Action -eq "/RESTART") { Write-Host "Restarting IIS" }
elseif ($Action -eq "/START") { Write-Host "Starting IIS" }
elseif ($Action -eq "/STOP") { Write-Host "Stopping IIS" }
else {
    Write-Error "Unknown action $action"
    exit 1
}

if (($errorAction -ne "Stop") -and ($errorAction -ne "Continue") -and ($errorAction -ne "SilentlyContinue")) {
    Write-Error "Unknown ErrorAction $errorAction"
    exit 1
}

if ($wait) {
    Write-Host "Running with wait"
    Start-Process -FilePath "iisreset" -ArgumentList $Action -ErrorAction $OctopusParameters["iisErrorAction"] -Wait
}
else {
    Write-Host "Running without wait"
    Start-Process -FilePath "iisreset" -ArgumentList $Action -ErrorAction $OctopusParameters["iisErrorAction"]
}

```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20IIS%20-%20Reset&step-template=IIS%20-%20Reset)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "2db9af2b-1d9a-4089-9d84-98d9118b39ad",
  "Name": "IIS - Reset",
  "Description": "Starts, stops, or resets IIS using iisreset",
  "Version": 1,
  "ExportedAt": "2017-07-31T09:29:18.058Z",
  "ActionType": "Octopus.Script",
  "Author": "zappy-shu",
  "Parameters": [
    {
      "Id": "aff3b743-7ca7-452b-a4bb-0bc4b4811763",
      "Name": "iisWait",
      "Label": "Wait for command to finish",
      "HelpText": null,
      "DefaultValue": "True",
      "DisplaySettings": {
        "Octopus.ControlType": "Checkbox"
      },
      "Links": {}
    },
    {
      "Id": "993ab611-208d-4a41-bd76-cd243fa5e5ce",
      "Name": "iisErrorAction",
      "Label": "Action on error",
      "HelpText": "",
      "DefaultValue": "Stop",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "Stop|Stop\nContinue|Continue\nSilentlyContinue|SilentlyContinue"
      },
      "Links": {}
    },
    {
      "Id": "a1826626-c86a-4ce0-892a-8a09a53f9f8b",
      "Name": "iisAction",
      "Label": "Action",
      "HelpText": "Start, stop, or reset",
      "DefaultValue": "/RESTART",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "/RESTART|Restart\n/START|Start\n/STOP|Stop"
      },
      "Links": {}
    }
  ],
  "Properties": {
    "Octopus.Action.Script.Syntax": "PowerShell",
    "Octopus.Action.Script.ScriptSource": "Inline",
    "Octopus.Action.RunOnServer": "false",
    "Octopus.Action.Script.ScriptBody": "$wait = $OctopusParameters[\"iisWait\"] -and [boolean]::Parse($OctopusParameters[\"iisWait\"])\n$action = $OctopusParameters[\"iisAction\"]\n$errorAction = $OctopusParameters[\"iisErrorAction\"]\nif ($Action -eq \"/RESTART\") { Write-Host \"Restarting IIS\" }\nelseif ($Action -eq \"/START\") { Write-Host \"Starting IIS\" }\nelseif ($Action -eq \"/STOP\") { Write-Host \"Stopping IIS\" }\nelse {\n    Write-Error \"Unknown action $action\"\n    exit 1\n}\n\nif (($errorAction -ne \"Stop\") -and ($errorAction -ne \"Continue\") -and ($errorAction -ne \"SilentlyContinue\")) {\n    Write-Error \"Unknown ErrorAction $errorAction\"\n    exit 1\n}\n\nif ($wait) {\n    Write-Host \"Running with wait\"\n    Start-Process -FilePath \"iisreset\" -ArgumentList $Action -ErrorAction $OctopusParameters[\"iisErrorAction\"] -Wait\n}\nelse {\n    Write-Host \"Running without wait\"\n    Start-Process -FilePath \"iisreset\" -ArgumentList $Action -ErrorAction $OctopusParameters[\"iisErrorAction\"]\n}\n",
    "Octopus.Action.Script.ScriptFileName": null,
    "Octopus.Action.Package.FeedId": null,
    "Octopus.Action.Package.PackageId": null
  },
  "Category": "IIS",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/iis-reset.json",
  "Website": "/step-templates/2db9af2b-1d9a-4089-9d84-98d9118b39ad",
  "Logo": "https://i.octopus.com/library/step-templates/iis.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/iis-reset.json)

</div>
