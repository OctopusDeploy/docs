---
layout: src/layouts/Default.astro
pubDate: 2014-05-30
title: 'SSL - Disable SSLv2'
description: 'Disables SSL v2, requires restart.'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2014-05-30 by bobjwalker belongs to 'SSL' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Server name

`Server`

Server name to disable SSL v2 on.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
Write-host "Server : $Server"
	$ClientEnabled = $false
	$ServerEnabled = $false
    $reg = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey('LocalMachine', $Server)
    $regkey = $reg.OpenSubkey("SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\SSL 2.0",$true)
	$regkeyC = $reg.OpenSubkey("SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\SSL 2.0\\Client",$true)
	$regkeyS = $reg.OpenSubkey("SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\SSL 2.0\\Server",$true)
	
	foreach($subkeyName in $regkey.GetSubKeyNames())
	{
#CLIENT
		# Check for Client SubKey
		if (!$regkeyC)			
		{
			$regkey.CreateSubKey('Client')
			#reload
			$regkeyC = $reg.OpenSubkey("SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\SSL 2.0\\Client",$true)
			$regkeyC.SetValue('DisabledByDefault','1','DWORD')
		}		
		foreach($subkeyNameC in $regkeyC.GetValueNames())
		{					
			if ($subkeyNameC)
			{
				if ($subkeyNameC -eq 'Enabled')
				{
					$ClientEnabled = $true
				}
			}
		}
		# Check to see if the Enabled Key was found
		if (!$ClientEnabled)
		{
			#Add enabled SubKey with DWORD value
			$regkeyC.SetValue('Enabled','0','DWORD')				
		}
#SERVER
		# Check for Server SubKey
		if (!$regkeyS)
		{
			$regkey.CreateSubKey('Server')
			#reload
			$regkeyS = $reg.OpenSubkey("SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\SSL 2.0\\Server",$true)
		}		
		foreach($subkeyNameS in $regkeyS.GetValueNames())
		{
			if ($subkeyNameS)
			{
				if ($subkeyNameS -eq 'Enabled')
				{
					$ServerEnabled = $true
				}
			}
		}		
		if (!$ServerEnabled)
		{
			#Add enabled SubKey with DWORD value
			$regkeyS.SetValue('Enabled','0','DWORD')
		}			
	} 
	Write-host "Server : $Server : Complete"
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20SSL%20-%20Disable%20SSLv2&step-template=SSL%20-%20Disable%20SSLv2)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "ea274d21-80ca-4c1b-aa82-f0d124c6a707",
  "Name": "SSL - Disable SSLv2",
  "Description": "Disables SSL v2, requires restart.",
  "Version": 1,
  "ExportedAt": "2014-05-30T20:48:41.172+00:00",
  "ActionType": "Octopus.Script",
  "Author": "bobjwalker",
  "Parameters": [
    {
      "Name": "Server",
      "Label": "Server name",
      "HelpText": "Server name to disable SSL v2 on.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "Write-host \"Server : $Server\"\n\t$ClientEnabled = $false\n\t$ServerEnabled = $false\n    $reg = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey('LocalMachine', $Server)\n    $regkey = $reg.OpenSubkey(\"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\",$true)\n\t$regkeyC = $reg.OpenSubkey(\"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Client\",$true)\n\t$regkeyS = $reg.OpenSubkey(\"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Server\",$true)\n\t\n\tforeach($subkeyName in $regkey.GetSubKeyNames())\n\t{\n#CLIENT\n\t\t# Check for Client SubKey\n\t\tif (!$regkeyC)\t\t\t\n\t\t{\n\t\t\t$regkey.CreateSubKey('Client')\n\t\t\t#reload\n\t\t\t$regkeyC = $reg.OpenSubkey(\"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Client\",$true)\n\t\t\t$regkeyC.SetValue('DisabledByDefault','1','DWORD')\n\t\t}\t\t\n\t\tforeach($subkeyNameC in $regkeyC.GetValueNames())\n\t\t{\t\t\t\t\t\n\t\t\tif ($subkeyNameC)\n\t\t\t{\n\t\t\t\tif ($subkeyNameC -eq 'Enabled')\n\t\t\t\t{\n\t\t\t\t\t$ClientEnabled = $true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t# Check to see if the Enabled Key was found\n\t\tif (!$ClientEnabled)\n\t\t{\n\t\t\t#Add enabled SubKey with DWORD value\n\t\t\t$regkeyC.SetValue('Enabled','0','DWORD')\t\t\t\t\n\t\t}\n#SERVER\n\t\t# Check for Server SubKey\n\t\tif (!$regkeyS)\n\t\t{\n\t\t\t$regkey.CreateSubKey('Server')\n\t\t\t#reload\n\t\t\t$regkeyS = $reg.OpenSubkey(\"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Server\",$true)\n\t\t}\t\t\n\t\tforeach($subkeyNameS in $regkeyS.GetValueNames())\n\t\t{\n\t\t\tif ($subkeyNameS)\n\t\t\t{\n\t\t\t\tif ($subkeyNameS -eq 'Enabled')\n\t\t\t\t{\n\t\t\t\t\t$ServerEnabled = $true\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t\tif (!$ServerEnabled)\n\t\t{\n\t\t\t#Add enabled SubKey with DWORD value\n\t\t\t$regkeyS.SetValue('Enabled','0','DWORD')\n\t\t}\t\t\t\n\t} \n\tWrite-host \"Server : $Server : Complete\"",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "SSL",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/ssl-disable-sslv2.json",
  "Website": "/step-templates/ea274d21-80ca-4c1b-aa82-f0d124c6a707",
  "Logo": "https://i.octopus.com/library/step-templates/ssl.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/ssl-disable-sslv2.json)

</div>
