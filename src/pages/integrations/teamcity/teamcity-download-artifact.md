---
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
layout: src/layouts/Default.astro
pubDate: 2015-01-23
title: 'TeamCity - Download Artifact'
description: 'Downloads the TeamCity artifact from the most recent build of the specified branch.'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
---

Octopus.Script exported 2015-01-23 by bobjwalker belongs to 'TeamCity' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### TeamCity Host

`TeamCityHost = `

The domain name and optional port of the TeamCity build server.
(ex. teamcity.mycompany.com:8080)

</div>
        
<div class="param">

### TeamCity Username

`TeamCityUsername`

The TeamCity username that is used to authenticate the request.  This user must have permissions to download the specified artifact.

</div>
        
<div class="param">

### TeamCity Password

`TeamCityPassword`

The TeamCity password that is used to authenticate the request.

</div>
        
<div class="param">

### Build Type ID

`BuildType`

The unique identifier of the TeamCity build configuration.

</div>
        
<div class="param">

### Branch Name

`BranchName = master`

The name of the branch whose artifact is being download.

</div>
        
<div class="param">

### Artifact Name

`ArtifactName`

The filename of the artifact being downloaded.

</div>
        
<div class="param">

### Output Location

`OutputLocation`

The name of the folder where the artifact will be downloaded.  The resulting file will match the filename of the artifact being downloaded.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
# Expected parameters:
#  $TeamCityHost     - The domain name and optional port (teamcity.mycompany.com:8080) of the TeamCity build server.
#  $TeamCityUsername - The TeamCity username.
#  $TeamCityPassword - The TeamCity password.
#  $BuildType        - The unique identifier of the TeamCity build configuration.
#  $BranchName       - The name of the branch.
#  $ArtifactName     - The filename of the artifact.
#  $OutputLocation   - The name of the folder where the artifact will be downloaded.

$secure_password = ConvertTo-SecureString $TeamCityPassword -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential($TeamCityUsername, $secure_password)

$resource_identifier = "buildType:$BuildType,branch:$BranchName"

$source = "http://$TeamCityHost/httpAuth/app/rest/builds/$resource_identifier/artifacts/content/$ArtifactName"
$destination = "$OutputLocation\$Artifactname"

Invoke-WebRequest $source -OutFile $destination -Credential $credential
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20TeamCity%20-%20Download%20Artifact&step-template=TeamCity%20-%20Download%20Artifact)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "55a172cc-de3d-45f9-90b1-be51042754b0",
  "Name": "TeamCity - Download Artifact",
  "Description": "Downloads the TeamCity artifact from the most recent build of the specified branch.",
  "Version": 2,
  "ExportedAt": "2015-01-23T04:15:51.361+00:00",
  "ActionType": "Octopus.Script",
  "Author": "bobjwalker",
  "Parameters": [
    {
      "Name": "TeamCityHost",
      "Label": "TeamCity Host",
      "HelpText": "The domain name and optional port of the TeamCity build server.\n(ex. teamcity.mycompany.com:8080)",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "TeamCityUsername",
      "Label": "TeamCity Username",
      "HelpText": "The TeamCity username that is used to authenticate the request.  This user must have permissions to download the specified artifact.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "TeamCityPassword",
      "Label": "TeamCity Password",
      "HelpText": "The TeamCity password that is used to authenticate the request.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "BuildType",
      "Label": "Build Type ID",
      "HelpText": "The unique identifier of the TeamCity build configuration.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "BranchName",
      "Label": "Branch Name",
      "HelpText": "The name of the branch whose artifact is being download.",
      "DefaultValue": "master",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "ArtifactName",
      "Label": "Artifact Name",
      "HelpText": "The filename of the artifact being downloaded.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "OutputLocation",
      "Label": "Output Location",
      "HelpText": "The name of the folder where the artifact will be downloaded.  The resulting file will match the filename of the artifact being downloaded.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "# Expected parameters:\n#  $TeamCityHost     - The domain name and optional port (teamcity.mycompany.com:8080) of the TeamCity build server.\n#  $TeamCityUsername - The TeamCity username.\n#  $TeamCityPassword - The TeamCity password.\n#  $BuildType        - The unique identifier of the TeamCity build configuration.\n#  $BranchName       - The name of the branch.\n#  $ArtifactName     - The filename of the artifact.\n#  $OutputLocation   - The name of the folder where the artifact will be downloaded.\n\n$secure_password = ConvertTo-SecureString $TeamCityPassword -AsPlainText -Force\n$credential = New-Object System.Management.Automation.PSCredential($TeamCityUsername, $secure_password)\n\n$resource_identifier = \"buildType:$BuildType,branch:$BranchName\"\n\n$source = \"http://$TeamCityHost/httpAuth/app/rest/builds/$resource_identifier/artifacts/content/$ArtifactName\"\n$destination = \"$OutputLocation\\$Artifactname\"\n\nInvoke-WebRequest $source -OutFile $destination -Credential $credential",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "TeamCity",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/teamcity-download-artifact.json",
  "Website": "/step-templates/55a172cc-de3d-45f9-90b1-be51042754b0",
  "Logo": "https://i.octopus.com/library/step-templates/teamcity.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/teamcity-download-artifact.json)

</div>
