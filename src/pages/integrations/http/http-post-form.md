---
layout: src/layouts/Default.astro
pubDate: 2015-11-13
title: 'HTTP - Post Form'
description: 'Execute a simple form POST via HTTP. The script will construct a body in "application/x-www-form-urlencoded" format by extracting Octopus variables with a specified prefix (from the "HTTP.PostForm.Prefix" parameter). Variable names and values are encoded accordingly.

For instance, if "HTTP.PostForm.Prefix" is "foo.", then the Octopus variable "foo.Bar"="baz" will be translated to "Bar=baz" in the request body.'
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2015-11-13 by kburdett belongs to 'HTTP' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### URI

`HTTP.PostForm.URI`

Specifies the destination of the POST.

</div>
        
<div class="param">

### Prefix

`HTTP.PostForm.Prefix = HTTP.Parameter.`

Specifies the variable prefix for composing the body of the POST. Any variables in the current context that begin with this prefix will be extracted and added to the body.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```PowerShell
try {    $uri = $OctopusParameters["HTTP.PostForm.URI"]    $prefix = $OctopusParameters["HTTP.PostForm.Prefix"]    $body = ""    # Ensure URI is populated    if ([string]::IsNullOrEmpty($uri)) {        Write-Error "HTTP.PostForm.URI is required and cannot be empty"        return    }    # Construct the body    if (![string]::IsNullOrEmpty($prefix)) {        $params = $OctopusParameters.Keys |            Where-Object { $_.StartsWith($prefix) } |            Foreach-Object {                $key = [uri]::EscapeDataString($_.Substring($prefix.Length))                $val = [uri]::EscapeDataString($OctopusParameters[$_])                Write-Verbose "Found parameter ${key}=${val}"                "${key}=${val}"            }            if ($params.Length -gt 0) {            $body = $params -join "&"        }    }        # Execute the request    Write-Host "Executing trigger: ${uri}"    Write-Host "Body: ${body}"    Invoke-WebRequest -Method Post -Uri $uri -Body $body -ContentType "application/x-www-form-urlencoded"} catch {    $ErrorMessage = $_.Exception.Message    Write-Error $ErrorMessage}
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20HTTP%20-%20Post%20Form&step-template=HTTP%20-%20Post%20Form)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "3c7a59bd-d66e-4dc6-9509-895b4a5d98c8",
  "Name": "HTTP - Post Form",
  "Description": "Execute a simple form POST via HTTP. The script will construct a body in \"application/x-www-form-urlencoded\" format by extracting Octopus variables with a specified prefix (from the \"HTTP.PostForm.Prefix\" parameter). Variable names and values are encoded accordingly.\n\nFor instance, if \"HTTP.PostForm.Prefix\" is \"foo.\", then the Octopus variable \"foo.Bar\"=\"baz\" will be translated to \"Bar=baz\" in the request body.",
  "Version": 2,
  "ExportedAt": "2015-11-13T21:57:26.839+00:00",
  "ActionType": "Octopus.Script",
  "Author": "kburdett",
  "Parameters": [
    {
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      },
      "HelpText": "Specifies the destination of the POST.",
      "Label": "URI",
      "Name": "HTTP.PostForm.URI"
    },
    {
      "DefaultValue": "HTTP.Parameter.",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      },
      "HelpText": "Specifies the variable prefix for composing the body of the POST. Any variables in the current context that begin with this prefix will be extracted and added to the body.",
      "Label": "Prefix",
      "Name": "HTTP.PostForm.Prefix"
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "try {\r    $uri = $OctopusParameters[\"HTTP.PostForm.URI\"]\r    $prefix = $OctopusParameters[\"HTTP.PostForm.Prefix\"]\r    $body = \"\"\r\r    # Ensure URI is populated\r    if ([string]::IsNullOrEmpty($uri)) {\r        Write-Error \"HTTP.PostForm.URI is required and cannot be empty\"\r        return\r    }\r\r    # Construct the body\r    if (![string]::IsNullOrEmpty($prefix)) {\r        $params = $OctopusParameters.Keys |\r            Where-Object { $_.StartsWith($prefix) } |\r            Foreach-Object {\r                $key = [uri]::EscapeDataString($_.Substring($prefix.Length))\r                $val = [uri]::EscapeDataString($OctopusParameters[$_])\r                Write-Verbose \"Found parameter ${key}=${val}\"\r                \"${key}=${val}\"\r            }\r    \r        if ($params.Length -gt 0) {\r            $body = $params -join \"&\"\r        }\r    }\r    \r    # Execute the request\r    Write-Host \"Executing trigger: ${uri}\"\r    Write-Host \"Body: ${body}\"\r    Invoke-WebRequest -Method Post -Uri $uri -Body $body -ContentType \"application/x-www-form-urlencoded\"\r} catch {\r    $ErrorMessage = $_.Exception.Message\r    Write-Error $ErrorMessage\r}",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "HTTP",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/http-post-form.json",
  "Website": "/step-templates/3c7a59bd-d66e-4dc6-9509-895b4a5d98c8",
  "Logo": "https://i.octopus.com/library/step-templates/http.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/http-post-form.json)

</div>
