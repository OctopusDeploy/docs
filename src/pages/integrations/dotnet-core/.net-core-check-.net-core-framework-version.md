---
layout: src/layouts/Default.astro
pubDate: 2018-06-13
title: '.NET Core - Check .NET Core Framework Version'
description: 'Check if given .NET Core framework version (or greater) is installed.'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2018-06-13 by FinnianDempsey belongs to '.NET Core' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Target .NET Core framework version

`TargetVersion = 2.0.5`

The target .NET Core framework version you expect to be installed in the machine. For example, 2.0.5.

</div>
        
<div class="param">

### Exact

`Exact = false`

If you check "Exact", it means the installed .NET Core framework version MUST match target version.

Otherwise, as long as the installed .NET Coreframework version is greater than or equal to target version, the check will pass.

</div>
        
<div class="param">

### Check ASP.NET Core Module

`CheckASPdotNETCore = false`

If you check "Check ASP.NET Core Module", it means this step will check if ASP.NET Core module is installed in the host or not.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
$ErrorActionPreference = "Stop" 
function Get-Parameter($Name, $Default, [switch]$Required) {
    $result = $null

    if ($OctopusParameters -ne $null) {
        $result = $OctopusParameters[$Name]
    }

    if ($result -eq $null) {
        if ($Required) {
            throw "Missing parameter value $Name"
        } else {
            $result = $Default
        }
    }

    return $result
}

function Get-DotNetCoreFrameworkVersions() {
    $dotNetCoreVersions = @()
    if(Test-Path "$env:programfiles/dotnet/shared/Microsoft.NETCore.App") {
        $dotNetCoreVersions = (ls "$env:programfiles/dotnet/shared/Microsoft.NETCore.App").Name
    }
    return $dotNetCoreVersions
}

function Get-AspDotNetCoreRuntimeVersions() {
    $aspDotNetCoreRuntimeVersions = @()
    $DotNETCoreUpdatesPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Updates\.NET Core"
    $DotNETUpdatesPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Updates\.NET"

    if (Test-Path "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Updates\.NET Core") {
	    $DotNetCoreItems = (Get-Item -Path $DotNETCoreUpdatesPath).GetSubKeyNames()
    }
    if (Test-Path "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Updates\.NET") {
        $DotNetItems = (Get-Item -Path $DotNETUpdatesPath).GetSubKeyNames()
    }
	$aspDotNetCoreRuntimeVersions = $DotNetCoreItems + $DotNetItems | where { $_ -match "^Microsoft (ASP)?\.NET Core (?<version>[\d\.]+(.*?)?) "} | foreach { $Matches['version'] }

    return $aspDotNetCoreRuntimeVersions
}

$targetVersion = (Get-Parameter "TargetVersion" -Required).Trim()
$exact = [boolean]::Parse((Get-Parameter "Exact" -Required))
$CheckASPdotNETCore = [boolean]::Parse((Get-Parameter "CheckASPdotNETCore" -Required))

$matchedVersions = Get-DotNetCoreFrameworkVersions | Where-Object { if ($exact) { $_ -eq $targetVersion } else { $_ -ge $targetVersion }  }
if (!$matchedVersions) { 
    throw "Can't find .NET Core Runtime $targetVersion installed in the machine."
}

$matchedVersions | foreach { Write-Host "Found .NET Core Runtime $_ installed in the machine." }

if ($CheckASPdotNETCore) {
    $matchedAspVersions = Get-AspDotNetCoreRuntimeVersions
    if (!$matchedAspVersions) {
        throw "Can't find ASP.NET Core Runtime installed in the machine."
    }

    $matchedAspVersions | foreach { Write-Host "Found ASP.NET Core Runtime $_ installed in the machine." }
}
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20.NET%20Core%20-%20Check%20.NET%20Core%20Framework%20Version&step-template=.NET%20Core%20-%20Check%20.NET%20Core%20Framework%20Version)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "929ff903-29de-4217-b6a9-83fbfd477e11",
  "Name": ".NET Core - Check .NET Core Framework Version",
  "Description": "Check if given .NET Core framework version (or greater) is installed.",
  "Version": 5,
  "ExportedAt": "2018-06-13T08:43:39.365Z",
  "ActionType": "Octopus.Script",
  "Author": "FinnianDempsey",
  "Parameters": [
    {
      "Id": "f386deb4-36fb-4116-ad4a-5bceed89fa5b",
      "Name": "TargetVersion",
      "Label": "Target .NET Core framework version",
      "HelpText": "The target .NET Core framework version you expect to be installed in the machine. For example, 2.0.5.",
      "DefaultValue": "2.0.5",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      },
      "Links": {}
    },
    {
      "Id": "7312dd89-2174-47d7-bdfd-2745fb812f58",
      "Name": "Exact",
      "Label": "Exact",
      "HelpText": "If you check \"Exact\", it means the installed .NET Core framework version MUST match target version.\n\nOtherwise, as long as the installed .NET Coreframework version is greater than or equal to target version, the check will pass.",
      "DefaultValue": "false",
      "DisplaySettings": {
        "Octopus.ControlType": "Checkbox"
      },
      "Links": {}
    },
    {
      "Id": "4f0b738b-8f06-4c93-a27f-49b3cd06ea9a",
      "Name": "CheckASPdotNETCore",
      "Label": "Check ASP.NET Core Module",
      "HelpText": "If you check \"Check ASP.NET Core Module\", it means this step will check if ASP.NET Core module is installed in the host or not.",
      "DefaultValue": "false",
      "DisplaySettings": {
        "Octopus.ControlType": "Checkbox"
      },
      "Links": {}
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptSource": "Inline",
    "Octopus.Action.Script.Syntax": "PowerShell",
    "Octopus.Action.Script.ScriptBody": "$ErrorActionPreference = \"Stop\" \nfunction Get-Parameter($Name, $Default, [switch]$Required) {\n    $result = $null\n\n    if ($OctopusParameters -ne $null) {\n        $result = $OctopusParameters[$Name]\n    }\n\n    if ($result -eq $null) {\n        if ($Required) {\n            throw \"Missing parameter value $Name\"\n        } else {\n            $result = $Default\n        }\n    }\n\n    return $result\n}\n\nfunction Get-DotNetCoreFrameworkVersions() {\n    $dotNetCoreVersions = @()\n    if(Test-Path \"$env:programfiles/dotnet/shared/Microsoft.NETCore.App\") {\n        $dotNetCoreVersions = (ls \"$env:programfiles/dotnet/shared/Microsoft.NETCore.App\").Name\n    }\n    return $dotNetCoreVersions\n}\n\nfunction Get-AspDotNetCoreRuntimeVersions() {\n    $aspDotNetCoreRuntimeVersions = @()\n    $DotNETCoreUpdatesPath = \"Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\.NET Core\"\n    $DotNETUpdatesPath = \"Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\.NET\"\n\n    if (Test-Path \"HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\.NET Core\") {\n\t    $DotNetCoreItems = (Get-Item -Path $DotNETCoreUpdatesPath).GetSubKeyNames()\n    }\n    if (Test-Path \"HKLM:\\SOFTWARE\\Wow6432Node\\Microsoft\\Updates\\.NET\") {\n        $DotNetItems = (Get-Item -Path $DotNETUpdatesPath).GetSubKeyNames()\n    }\n\t$aspDotNetCoreRuntimeVersions = $DotNetCoreItems + $DotNetItems | where { $_ -match \"^Microsoft (ASP)?\\.NET Core (?<version>[\\d\\.]+(.*?)?) \"} | foreach { $Matches['version'] }\n\n    return $aspDotNetCoreRuntimeVersions\n}\n\n$targetVersion = (Get-Parameter \"TargetVersion\" -Required).Trim()\n$exact = [boolean]::Parse((Get-Parameter \"Exact\" -Required))\n$CheckASPdotNETCore = [boolean]::Parse((Get-Parameter \"CheckASPdotNETCore\" -Required))\n\n$matchedVersions = Get-DotNetCoreFrameworkVersions | Where-Object { if ($exact) { $_ -eq $targetVersion } else { $_ -ge $targetVersion }  }\nif (!$matchedVersions) { \n    throw \"Can't find .NET Core Runtime $targetVersion installed in the machine.\"\n}\n\n$matchedVersions | foreach { Write-Host \"Found .NET Core Runtime $_ installed in the machine.\" }\n\nif ($CheckASPdotNETCore) {\n    $matchedAspVersions = Get-AspDotNetCoreRuntimeVersions\n    if (!$matchedAspVersions) {\n        throw \"Can't find ASP.NET Core Runtime installed in the machine.\"\n    }\n\n    $matchedAspVersions | foreach { Write-Host \"Found ASP.NET Core Runtime $_ installed in the machine.\" }\n}"
  },
  "Category": ".NET Core",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/windows-check-net-core-framework-version.json",
  "Website": "/step-templates/929ff903-29de-4217-b6a9-83fbfd477e11",
  "Logo": "https://i.octopus.com/library/step-templates/dotnetcore.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/windows-check-net-core-framework-version.json)

</div>
