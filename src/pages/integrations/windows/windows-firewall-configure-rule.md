---
layout: src/layouts/Default.astro
pubDate: 2014-05-16
title: 'Windows Firewall - Configure Rule'
description: 'Configures a firewall rule'
navMenu: false
# Set to true when launched
navSitemap: false
navSearch: false
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2014-05-16 by bobjwalker belongs to 'Windows' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Rule name

`RuleName`

The name of the rule

</div>
        
<div class="param">

### Local Port

`LocalPort`

The comma separated list of local port values

</div>
        
<div class="param">

### Remote Port

`RemotePort = any`

The comma separated list of remote port values

</div>
        
<div class="param">

### Protocol

`Protocol = TCP`

The protocol for the rule. Commonly either 'TCP or 'UDP'

</div>
        
<div class="param">

### Direction

`Direction`

The rule direction. Either 'in' or 'out'

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```powershell
$ruleName = $OctopusParameters['RuleName']
$localPort = $OctopusParameters['LocalPort']
$remotePort = $OctopusParameters['RemotePort']
$protocol = $OctopusParameters['Protocol']
$direction = $OctopusParameters['Direction']

# Remove any existing rule

Write-Host "Removing existing rule"
netsh advfirewall firewall delete rule name="$ruleName" dir=$direction

# Add new rule

Write-Host "Adding new rule"
netsh advfirewall firewall add rule name="$ruleName" dir=$direction action=allow protocol=$protocol localport=$localPort remoteport=$remotePort
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20Windows%20Firewall%20-%20Configure%20Rule&step-template=Windows%20Firewall%20-%20Configure%20Rule)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "e47a9558-e49c-44a6-ae8f-66372b285789",
  "Name": "Windows Firewall - Configure Rule",
  "Description": "Configures a firewall rule",
  "Version": 4,
  "ExportedAt": "2014-05-16T10:13:17.207+00:00",
  "ActionType": "Octopus.Script",
  "Author": "bobjwalker",
  "Parameters": [
    {
      "Name": "RuleName",
      "Label": "Rule name",
      "HelpText": "The name of the rule",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "LocalPort",
      "Label": "Local Port",
      "HelpText": "The comma separated list of local port values",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "RemotePort",
      "Label": "Remote Port",
      "HelpText": "The comma separated list of remote port values",
      "DefaultValue": "any",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "Protocol",
      "Label": "Protocol",
      "HelpText": "The protocol for the rule. Commonly either 'TCP or 'UDP'",
      "DefaultValue": "TCP",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "Direction",
      "Label": "Direction",
      "HelpText": "The rule direction. Either 'in' or 'out'",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "$ruleName = $OctopusParameters['RuleName']\n$localPort = $OctopusParameters['LocalPort']\n$remotePort = $OctopusParameters['RemotePort']\n$protocol = $OctopusParameters['Protocol']\n$direction = $OctopusParameters['Direction']\n\n# Remove any existing rule\n\nWrite-Host \"Removing existing rule\"\nnetsh advfirewall firewall delete rule name=\"$ruleName\" dir=$direction\n\n# Add new rule\n\nWrite-Host \"Adding new rule\"\nnetsh advfirewall firewall add rule name=\"$ruleName\" dir=$direction action=allow protocol=$protocol localport=$localPort remoteport=$remotePort",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "Windows",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/windows-firewall-configure-rule.json",
  "Website": "/step-templates/e47a9558-e49c-44a6-ae8f-66372b285789",
  "Logo": "https://i.octopus.com/library/step-templates/windows.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/windows-firewall-configure-rule.json)

</div>
