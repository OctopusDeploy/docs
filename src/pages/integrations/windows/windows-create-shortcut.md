---
layout: src/layouts/Default.astro
pubDate: 2015-12-23
title: 'Windows - Create Shortcut'
description: 'Creates or updates a Windows shortcut to point to a target file.'
# This file is auto-generated by docs/tools/MarkdownGenerator (detail.js)
---

Octopus.Script exported 2015-12-23 by bobjwalker belongs to 'Windows' category.

## Parameters

When steps based on the template are included in a project's deployment process, the parameters below can be set.


<div class="param">

### Target file the shortcut will reference

`TargetFilePath`

This should be set to the file that the shortcut will link to.

</div>
        
<div class="param">

### Choose a destination for the shortcut or a Custom path.

`ShortcutDestination = PublicDesktop`



</div>
        
<div class="param">

### The path the shortcut will be put in if Custom path is chosen

`ShortcutPath`

This path is only used if Custom is set as destination for the shortcut. This should include a path that the shortcut should live in.  If the path does not exist, it will be created.

</div>
        
<div class="param">

### The name of the shortcut

`ShortcutName`

This should be the name of the shortcut.

</div>
        

## Script body

Steps based on this template will execute the following *PowerShell* script.

```PowerShell
$destination = $OctopusParameters['ShortcutDestination']
$targetFilePath = $OctopusParameters['TargetFilePath']
$shortcutName = $OctopusParameters['Shortcutname']

#Use Custom or predefined path
$shortcutDestination = 
    if($destination -eq "PublicDesktop") { "$env:PUBLIC\Desktop" }
    elseif($destination -eq "Custom") { $OctopusParameters['ShortcutPath'] }
    else {Write-Error "Shortcut destination is not set"}


#Create shortcut filename
$shortcut = "$shortcutDestination\$shortcutName.lnk"

Write-Output "Shortcut: $shortcut"
Write-Output "Target: $targetFilePath"

if(!(Test-Path $destination)){
    New-Item -ItemType Directory -Path $destination
}

$WshShell = New-Object -comObject WScript.Shell
$Shortcut = $WshShell.CreateShortcut("$shortcut")
$Shortcut.TargetPath = $targetFilePath
$Shortcut.Save()
```

Provided under the [Apache License version 2.0](https://github.com/OctopusDeploy/Library/blob/master/LICENSE.txt).

[Report an issue](https://github.com/OctopusDeploy/Library/issues/new?assignees=&labels=&projects=&template=bug-report.yml&title=Issue%20with%20Windows%20-%20Create%20Shortcut&step-template=Windows%20-%20Create%20Shortcut)

<div class="get-json">

To use this template in Octopus Deploy, copy the JSON below and paste it into the **Library → Step templates → Import** dialog.

```json
{
  "Id": "95ed2a99-f92a-482e-a625-bbd1fb7c24bc",
  "Name": "Windows - Create Shortcut",
  "Description": "Creates or updates a Windows shortcut to point to a target file.",
  "Version": 7,
  "ExportedAt": "2015-12-23T09:41:47.577+00:00",
  "ActionType": "Octopus.Script",
  "Author": "bobjwalker",
  "Parameters": [
    {
      "Name": "TargetFilePath",
      "Label": "Target file the shortcut will reference",
      "HelpText": "This should be set to the file that the shortcut will link to.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "ShortcutDestination",
      "Label": "Choose a destination for the shortcut or a Custom path.",
      "HelpText": "",
      "DefaultValue": "PublicDesktop",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "PublicDesktop|Desktop (All Users)\nCustom|Custom"
      }
    },
    {
      "Name": "ShortcutPath",
      "Label": "The path the shortcut will be put in if Custom path is chosen",
      "HelpText": "This path is only used if Custom is set as destination for the shortcut. This should include a path that the shortcut should live in.  If the path does not exist, it will be created.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Name": "ShortcutName",
      "Label": "The name of the shortcut",
      "HelpText": "This should be the name of the shortcut.",
      "DefaultValue": null,
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptBody": "$destination = $OctopusParameters['ShortcutDestination']\n$targetFilePath = $OctopusParameters['TargetFilePath']\n$shortcutName = $OctopusParameters['Shortcutname']\n\n#Use Custom or predefined path\n$shortcutDestination = \n    if($destination -eq \"PublicDesktop\") { \"$env:PUBLIC\\Desktop\" }\n    elseif($destination -eq \"Custom\") { $OctopusParameters['ShortcutPath'] }\n    else {Write-Error \"Shortcut destination is not set\"}\n\n\n#Create shortcut filename\n$shortcut = \"$shortcutDestination\\$shortcutName.lnk\"\n\nWrite-Output \"Shortcut: $shortcut\"\nWrite-Output \"Target: $targetFilePath\"\n\nif(!(Test-Path $destination)){\n    New-Item -ItemType Directory -Path $destination\n}\n\n$WshShell = New-Object -comObject WScript.Shell\n$Shortcut = $WshShell.CreateShortcut(\"$shortcut\")\n$Shortcut.TargetPath = $targetFilePath\n$Shortcut.Save()",
    "Octopus.Action.Script.Syntax": "PowerShell"
  },
  "Category": "Windows",
  "HistoryUrl": "https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/windows-create-shortcut.json",
  "Website": "/step-templates/95ed2a99-f92a-482e-a625-bbd1fb7c24bc",
  "Logo": "https://i.octopus.com/library/step-templates/windows.png",
  "$Meta": {
    "Type": "ActionTemplate"
  }
}
```

[History](https://github.com/OctopusDeploy/Library/commits/master/step-templates/https://github.com/OctopusDeploy/Library/commits/master/step-templates//opt/buildagent/work/75443764cd38076d/step-templates/windows-create-shortcut.json)

</div>
